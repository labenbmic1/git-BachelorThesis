\NeedsTeXFormat{LaTeX2e}%
\ProvidesExplPackage {packages/tumtdo} {\TUMversiondate} {\TUMversion}%
	{The todonotes-part made by Michael Labenbacher}%
\ProcessKeysPackageOptions{packages/tumtdo}%
\ExplSyntaxOff%
%% ================================== LOF-names ===================================
\makeatletter%
\AtBeginDocument{%
	\TUM@ifpackageloaded[setting]{babel}{%
		\AfterEndPreamble{%
			\TUM@addto@extras@renew{american,english}{@todonotes@todolistname}{List of Todos}%
			\TUM@addto@extras@renew{american,english}{@todonotes@SetMissingFigureUp}{Missing}%
			\TUM@addto@extras@renew{american,english}{@todonotes@MissingFigureText}{Figure}%
			\TUM@addto@extras@renew{american,english}{@todonotes@SetMissingFigureDown}{figure}%
			\TUM@addto@extras@renew{naustrian,ngerman}{@todonotes@todolistname}{Todoverzeichnis}%
			\TUM@addto@extras@renew{naustrian,ngerman}{@todonotes@SetMissingFigureUp}{Fehlende}%
			\TUM@addto@extras@renew{naustrian,ngerman}{@todonotes@MissingFigureText}{Abbildung}%
		}%
	}{}%
}%
\makeatother%
%% ========================== Definition of the TUM-TDO ===========================
\setuptodonotes{line, noinline, list}%
\NewDocumentCommand{\todoUnsure}{O{}m}{%
	\todo[linecolor=\TUMcolor{todo-1}, backgroundcolor=\TUMcolor{todo-1}!25,%
		bordercolor=\TUMcolor{todo-1},#1]{#2}%
}%
\NewDocumentCommand{\todoChange}{O{}m}{%
	\todo[linecolor=\TUMcolor{todo-2}, backgroundcolor=\TUMcolor{todo-2}!25,%
		bordercolor=\TUMcolor{todo-2},#1]{#2}%
}%
\NewDocumentCommand{\todoInfo}{O{}m}{%
	\todo[linecolor=\TUMcolor{todo-3}, backgroundcolor=\TUMcolor{todo-3}!25,%
		bordercolor=\TUMcolor{todo-3},#1]{#2}%
}%
\NewDocumentCommand{\todoImprovement}{O{}m}{%
	\todo[linecolor=\TUMcolor{todo-4}, backgroundcolor=\TUMcolor{todo-4}!25,%
		bordercolor=\TUMcolor{todo-4},#1]{#2}%
}%
\NewDocumentCommand{\todoMissing}{O{}m}{%
	\todo[linecolor=\TUMcolor{todo-5}, backgroundcolor=\TUMcolor{todo-5}!25,%
		bordercolor=\TUMcolor{todo-5},#1]{#2}%
}%
\makeatletter%
\renewcommand{\listoftodos}[1][\@todonotes@todolistname]{%
	\if@todonotes@disabled\else%
		\@ifundefined{chapter}{\section*{#1}}{\chapter*{#1}}%
		\todototoc\@starttoc{tdo}%
	\fi%
}%
\NewDocumentCommand{\TUMlistoftodos}{}{%
	\newpage%
	\pagestyle{scrheadings}%
	\listoftodos%
	\newpage%
}%
\TUM@ifpackageloaded[setting]{microtype}{%
	\pretocmd{\TUMlistoftodos}{\newpage\microtypesetup{protrusion=false}}{}{}%
	\apptocmd{\TUMlistoftodos}{\microtypesetup{protrusion=true}\newpage}{}{}%
}{}%
\makeatother%
\endinput%
